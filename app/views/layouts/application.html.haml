!!!
%html
  %head
    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}/
    %title Koala
    %meta{:content => "width=device-width,initial-scale=1", :name => "viewport"}/
    = csrf_meta_tags
    = csp_meta_tag
    = stylesheet_link_tag "tailwind", "inter-font", "data-turbo-track": "reload"
    = stylesheet_link_tag "application", "data-turbo-track": "reload"
    = javascript_importmap_tags
  %body
    .grid.grid-cols-1.h-screen.w-full{class: 'md:grid-cols-3 lg:grid-cols-4'}
      / Tags
      #tags-list.col-span-1.bg-neutral-800.h-full.divide-y.divide-neutral-700.overflow-scroll.hidden{class: 'lg:block'}
        %div.py-5
          .flex.flex-row.justify-start.uppercase.text-xs.px-7.font-medium.text-neutral-400
            Categories

          .flex.flex-col.gap-1.mt-2.px-5
            = link_to notes_path do
              .w-full.p-2.text-white.rounded-md.flex.flex-row.items-center.gap-2{class: "#{@tag.nil? ? 'bg-teal-400' : 'hover:bg-neutral-700'}"}
                %i.text-white.w-4{'data-feather': "file"}
                All Notes

        %div
          .flex.flex-row.justify-start.uppercase.text-xs.pl-7.pt-5.font-medium.text-neutral-400
            Tags
          .flex.flex-col.gap-1.px-5.py-2
            - @tags.each do |tag|
              = link_to notes_path(tag: tag) do
                .flex.flex-row.items-center.gap-2.w-full.p-2.text-white.rounded-md{class: "#{@tag == tag ? 'bg-teal-400' : 'hover:bg-neutral-700'}"}
                  %i.text-white.w-4{'data-feather': "hash"}
                  = tag[1..-1]


      #notes-list.col-span-1.bg-neutral-100.h-full.overflow-scroll.hidden{class: 'md:block'}
        .flex.flex-row.justify-between.items-center.uppercase.text-xs.px-5.font-medium.text-neutral-400.pt-5.pb-3.border-b.sticky
          Notes
          = link_to notes_path(tag: @tag) do
            .flex.flex-row.gap-2.items-center.text-teal-400
              %i.text-white.w-3.text-teal-400{'data-feather': "plus"}
              New Note
            
        - @notes.each do |note|
          = link_to note_path(id: note.slug, tag: @tag) do
            .p-5.flex.flex-col.gap-1.border-b.relative{class: "hover:bg-neutral-200 #{@note == note ? 'bg-neutral-200': nil}"}
              - if @note == note
                .absolute.w-1.bg-teal-400.inset-y-0.left-0.h-full
              .text-neutral-800.font-medium.text-lg
                = note.content.split("\n").first&.truncate(30)
              .text-neutral-500.font-base.text-xs
                #{time_ago_in_words(note.created_at)} ago
              .text-neutral-700.font-base.text-sm
                = note.content.truncate(70)
      = yield
